<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>JDBC Guide</title>
    <meta name="description"
          content="JDBC stands for Java Database Connectivity. It is a standard Java API for database-independent connectivity between the Java programming language and a wide ...">

    <!-- Begin Jekyll SEO tag v2.0.0 -->
<meta property="og:title" content="JDBC Guide" />
<meta name="description" content="JDBC stands for Java Database Connectivity. It is a standard Java API for database-independent connectivity between the Java programming language and a wide range of databases." />
<meta property="og:description" content="JDBC stands for Java Database Connectivity. It is a standard Java API for database-independent connectivity between the Java programming language and a wide range of databases." />
<link rel="canonical" href="http://localhost:4000/jdbc/JDBC-Guide/" />
<meta property="og:url" content="http://localhost:4000/jdbc/JDBC-Guide/" />
<meta property="og:site_name" content="汀汀涔涔" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-11-02T00:00:00+08:00" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "JDBC Guide",
    "datePublished": "2015-11-02T00:00:00+08:00",
    "description": "JDBC stands for Java Database Connectivity. It is a standard Java API for database-independent connectivity between the Java programming language and a wide range of databases.",
    "url": "http://localhost:4000/jdbc/JDBC-Guide/"
  }
</script>
<!-- End Jekyll SEO tag -->

    <link rel="canonical" href="http://localhost:4000/jdbc/JDBC-Guide/">
    <link rel="alternate" type="application/rss+xml" title="汀汀涔涔" href="http://localhost:4000/feed.xml">

    <script type="text/javascript" src="/components/jquery/jquery.min.js"></script>

    <!-- Third-Party CSS -->
    <link rel="stylesheet" href="/components/bootstrap/css/bootstrap.min.css">

    <!-- My CSS -->
    <link rel="stylesheet" href="/assets/css/common.css">

    <!-- CSS set in page -->
    

    <!-- CSS set in layout -->
    
    <link rel="stylesheet" href="/assets/css/sidebar-post-nav.css">
    

    <script type="text/javascript" src="/components/bootstrap/js/bootstrap.min.js"></script>

</head>


    <body>

    <header class="site-header">
    <div class="container">
        <a id="site-header-brand" href="/" title="汀汀涔涔">
            <span class="octicon octicon-mark-github"></span> 汀汀涔涔
        </a>
        <nav class="site-header-nav" role="navigation">
            
            <a href="/"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Home">
                Home
            </a>
            
            <a href="/open-source"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Open-Source">
                Open-Source
            </a>
            
            <a href="/blog"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Blog">
                Blog
            </a>
            
            <a href="/tags"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Tags">
                Tags
            </a>
            
            <a href="/categories"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Categories">
                Categories
            </a>
            
            <a href="/about"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="About">
                About
            </a>
            
        </nav>
    </div>
</header>


        <div class="content">
            <section class="jumbotron geopattern" data-pattern-id="JDBC Guide">
    <div class="container">
        <div id="jumbotron-meta-info">
            <h1>JDBC Guide</h1>
            <span class="meta-info">
                
                
                <span class="octicon octicon-calendar"></span> 2015/11/02
                
                 |
                 Posted in jdbc
                
                 |
                
                  <a href="/tags#java" class="post-tag">
                      <span class="glyphicon glyphicon-tag small"></span> java
                  </a>
                
                  <a href="/tags#jdbc" class="post-tag">
                      <span class="glyphicon glyphicon-tag small"></span> jdbc
                  </a>
                
                
            </span>
        </div>
    </div>
</section>
<script>
    $(document).ready(function(){

        $('.geopattern').each(function(){
            $(this).geopattern($(this).data('pattern-id'));
        });

    });
</script>
<article class="post container" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="row">

        <div class="col-md-8 markdown-body">

            <p>JDBC stands for <strong>Java Database Connectivity</strong>. It is a standard Java API for database-independent connectivity between the Java programming language and a wide range of databases.</p>

<p>It includes APIs for the tasks mentioned below:</p>

<ul>
  <li>Making a connection to a database.</li>
  <li>Creating SQL statements.</li>
  <li>Executing SQL statements.</li>
  <li>Viewing &amp; Modifying the resulting records.</li>
</ul>

<h2 id="steps-to-use-jdbc">Steps to use JDBC</h2>

<h3 id="add-libs">Add libs</h3>

<p>To use jdbc, we must add related libs firstly in the buildpath/classpath. For example, with mysql, we must download <strong>mysql-connector-java-*.jar</strong>. According to different IDEs, we will also have different ways to add them. In IDEA, it needs to put jars in a lib folder on your root and right click, choose <strong>add as Library</strong>.</p>

<h3 id="import-packages">Import packages</h3>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.sql.*</span><span class="o">;</span> <span class="c1">// JDBC packages.  </span>
<span class="kn">import</span> <span class="nn">java.math.*</span><span class="o">;</span> <span class="c1">// To support BigDecimal and BigInteger only</span></code></pre></figure>

<p>Import the following two packages if we need to use extended functionality provided by the Oracle driver. Check more details <a href="https://docs.oracle.com/cd/F49540_01/DOC/java.815/a64685/oraext.htm#1000888">here</a></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">oracle.jdbc.driver.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">oracle.sql.*</span><span class="o">;</span></code></pre></figure>

<h3 id="register-jdbc-driver">Register JDBC driver</h3>

<p>Prior to JDBC 4.0, we must manually load drivers with the method <code class="highlighter-rouge">Class.forName</code></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span> <span class="c1">// For mysql</span>
<span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"oracle.jdbc.driver.OracleDriver"</span><span class="o">);</span> <span class="c1">// For oracle</span></code></pre></figure>

<p>For the other drivers, we could check <a href="http://www.sql-workbench.net/manual/jdbc-setup.html">JDBC Driver List</a> for details.</p>

<p>According to <a href="http://docs.oracle.com/javase/tutorial/jdbc/basics/connecting.html">Oracle Java Tutorials</a>, any JDBC &gt;= 4.0 drivers that are found in your classpath are automatically loaded.</p>

<h3 id="open-a-connection">Open a connection</h3>

<p>To open a connection, we must invoke <code class="highlighter-rouge">DriverManager.getConnection()</code> with following parameters:</p>

<ol>
  <li>URL (jdbc:sqlType://hostname:port/dataBaseName?Param=Value&amp;Param=Value)</li>
  <li>Username</li>
  <li>Password</li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="s">"jdbc:mysql://host:port/databaseName"</span><span class="o">,</span> <span class="s">"username"</span><span class="o">,</span> <span class="s">"password"</span><span class="o">);</span></code></pre></figure>

<h4 id="mysql-url-example">MySQL URL example</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nl">jdbc:mysql:</span><span class="c1">//localhost:3306/testDB?useUnicode=true&amp;characterEncoding=utf-8</span></code></pre></figure>

<p><strong>useUnicode=true&amp;characterEncoding=utf-8</strong> here is very useful to avoid some character problems like Chinese even if you already set utf-8 when created tables.</p>

<h4 id="good-practice">Good Practice</h4>

<ul>
  <li>Keep all the DB configurations in a properties file</li>
</ul>

<p>For example, now we have <strong>DBConfig.properties</strong>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">driver</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="na">mysql</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">Driver</span>
<span class="n">url</span><span class="o">=</span><span class="nl">jdbc:mysql:</span><span class="c1">//localhost:3306/testDB?useUnicode=true&amp;characterEncoding=utf-8</span>
<span class="n">user</span><span class="o">=</span><span class="n">root</span>
<span class="n">password</span><span class="o">=</span><span class="n">abcdefg</span></code></pre></figure>

<p>Then load this file and get connection by a DBHelper class:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DBHelper</span> <span class="o">{</span>
	
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">driver</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">url</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">user</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="n">connection</span><span class="o">;</span>
	
	<span class="kd">static</span> <span class="o">{</span>
		<span class="n">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">InputStream</span> <span class="n">input</span> <span class="o">=</span> <span class="n">DBHelper</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">()</span>
					<span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"DBConfig.properties"</span><span class="o">);</span>
			<span class="n">properties</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
		
		<span class="n">driver</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"driver"</span><span class="o">);</span>
		<span class="n">url</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"url"</span><span class="o">);</span>
		<span class="n">user</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"user"</span><span class="o">);</span>
		<span class="n">password</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
		
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
			<span class="n">connection</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">user</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
			<span class="k">return</span> <span class="n">connection</span><span class="o">;</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
		<span class="o">}</span>	

	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="creat-a-statement">Creat a statement</h3>

<p>There are three kinds of statements:</p>

<ol>
  <li>
    <p><strong>Statement</strong> is for general-purpose. Useful when you are using static SQL statements at runtime. Do not accept parameters.</p>
  </li>
  <li>
    <p><strong>PreparedStatement</strong> interface extends the Statement interface. It is used to execute a statement many times. It accepts input parameters at runtime.</p>
  </li>
  <li>
    <p><strong>CallableStatement</strong>  is used to access the database stored procedures. It accepts runtime input parameters.</p>
  </li>
</ol>

<h4 id="statement">Statement</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="c1">// ResultSet result = stmt.executeQuery("SELECT * FROM Employees");</span></code></pre></figure>

<p>Because <code class="highlighter-rouge">Statement</code> does not accept parameters, so we could only use it to execute some static queries.</p>

<h4 id="preparedstatement">PreparedStatement</h4>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">SQL</span> <span class="o">=</span> <span class="s">"Update Employees SET age = ? WHERE name = ?"</span><span class="o">;</span>
<span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">SQL</span><span class="o">);</span>

<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">29</span><span class="o">);</span>
<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">"Jack"</span><span class="o">);</span></code></pre></figure>

<p><strong>?</strong> symbol is known as the <strong>parameter marker</strong>. We must supply values for every parameter before executing SQL statement.</p>

<p>The <code class="highlighter-rouge">setXXX()</code> methods bind values to the parameters, where XXX represents the Java data type of the value you wish to bind to the input parameter. Each parameter marker is referred by its ordinal position. The first marker represents position 1, then 2, and so forth. (Not from 0!)</p>

<p>So with the help of parameter marker, we could prepare a SQL statement which will be used many times by <code class="highlighter-rouge">PreparedStatement</code>. We only need to set the values before executing it.</p>

<h4 id="callablestatement">CallableStatement</h4>

<p>//Todo</p>

<h3 id="execute-a-statement">Execute a statement</h3>

<ul>
  <li>
    <p><strong>boolean execute(String SQL)</strong> returns true if a ResultSet object can be retrieved; otherwise, false. Use this method to execute SQL DDL statements which you only need to know whether excuted sucessfully or not.</p>
  </li>
  <li>
    <p><strong>int executeUpdate(String SQL)</strong> returns the number of rows affected. Use this method when we expect to get number of rows affected - for example, an INSERT, UPDATE, or DELETE statement.</p>
  </li>
  <li>
    <p><strong>ResultSet executeQuery(String SQL)</strong> returns a ResultSet object. Use this method when you expect to get a result set, as you would with a SELECT statement.</p>
  </li>
</ul>

<blockquote>
  <p>For prepared statement, do not need to string sql as input.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Statement</span>
<span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT id, first, last, age FROM Employees"</span><span class="o">;</span>
<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>

<span class="c1">// PreparedStatement</span>
<span class="n">String</span> <span class="n">SQL</span> <span class="o">=</span> <span class="s">"Update Employees SET age = ? WHERE name = ?"</span><span class="o">;</span>
<span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">SQL</span><span class="o">);</span>

<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">29</span><span class="o">);</span>
<span class="n">preparedStatement</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">"Jack"</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">preparedStatement</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span></code></pre></figure>

<h3 id="extract-datas">Extract datas</h3>

<p>We use <code class="highlighter-rouge">ResultSet.getXXX()</code> to etract datas from result set by <strong>column name</strong>.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
    <span class="n">String</span> <span class="n">name</span>  <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"age"</span><span class="o">);</span>

    <span class="c1">//ToDo</span>
<span class="o">}</span></code></pre></figure>

<h3 id="close">Close</h3>

<p>We must clean up environment</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">// Close firstly resultSet</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">// Then we should close statement</span>
<span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">// In the end, close connection</span></code></pre></figure>

<h2 id="transaction">Transaction</h2>

<p>JDBC is in auto-commit mode by default which means every SQL statement is committed to the database upon its completion. For <a href="https://en.wikipedia.org/wiki/Transaction_processing">Transaction</a> of JDBC, we need to set <strong>false</strong> of <code class="highlighter-rouge">setAutoCommit()</code> for a connection. So in this way, only when we invoke manually <code class="highlighter-rouge">commit()</code> of a connection, all the operations will be validated. If any exception happens, we need to <code class="highlighter-rouge">rollback()</code> which will cancel all the operations:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">try</span> <span class="o">{</span> 
    <span class="err">…</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

    <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span> 
    <span class="n">stmt</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"...."</span><span class="o">);</span>
    <span class="n">stmt</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"...."</span><span class="o">);</span>
    <span class="n">stmt</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"...."</span><span class="o">);</span>

    <span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span> <span class="c1">// Everthing is right! Validate it!</span>
 <span class="o">}</span> 
 <span class="k">catch</span><span class="o">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">try</span> <span class="o">{</span> 
         <span class="n">conn</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span> <span class="c1">// Roll back all the operations</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SQLException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span> 
 <span class="o">}</span></code></pre></figure>

<h4 id="using-savepoints">Using Savepoints</h4>

<p>With a savepoint, we could rollback to use the rollback method to undo only the changes made after the savepoint. The <code class="highlighter-rouge">Connection</code> and <code class="highlighter-rouge">Statement</code>/<code class="highlighter-rouge">PreparedStatement</code> object has three methods about it:</p>

<ol>
  <li><code class="highlighter-rouge">Connection</code> - <code class="highlighter-rouge">setSavepoint(String savepointName)</code>: defines a new savepoint. It returns a <code class="highlighter-rouge">Savepoint</code> object.</li>
  <li><code class="highlighter-rouge">Connection</code> - <code class="highlighter-rouge">rollback(Savepoint savepoint)</code>: rolls back to the specified savepoint.</li>
  <li><code class="highlighter-rouge">Statement</code>/<code class="highlighter-rouge">PreparedStatement</code> - <code class="highlighter-rouge">releaseSavepoint(Savepoint savepoint)</code>: releases a savepoint. Do not forget it!</li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="s">"...."</span><span class="o">);</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="s">"...."</span><span class="o">);</span>

<span class="n">Savepoint</span> <span class="n">savepoint</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">setSavepoint</span><span class="o">();</span> <span class="c1">// Set save point</span>

<span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="s">"...."</span><span class="o">);</span>

<span class="c1">// Rollback to the savepoint for some reasons</span>
<span class="n">conn</span><span class="o">.</span><span class="na">rollback</span><span class="o">(</span><span class="n">savepoint</span><span class="o">);</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>

<span class="c1">// Do not forget to release it!</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">releaseSavepoint</span><span class="o">(</span><span class="n">savepoint</span><span class="o">);</span></code></pre></figure>

<h2 id="batch-processing">Batch Processing</h2>

<p>Batch Processing allows us to <strong>group related SQL statements into a batch and submit them with one call to the database</strong>. <code class="highlighter-rouge">Statement</code>, <code class="highlighter-rouge">PreparedStatement</code>, and <code class="highlighter-rouge">CallableStatement</code> have following methods to support it:</p>

<ol>
  <li><code class="highlighter-rouge">addBatch()</code> is used to add individual statements to the batch.</li>
  <li><code class="highlighter-rouge">executeBatch()</code> is used to start the execution of all the statements grouped together. It returns an array of integers, and each element of the array represents the update count for the respective update statement.</li>
  <li><code class="highlighter-rouge">clearBatch()</code> removes all the statements you added with the addBatch() method. However, you cannot selectively choose which statement :(</li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

<span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">addBatch</span><span class="o">(</span><span class="s">"..."</span><span class="o">);</span> <span class="c1">// Add in batch</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">addBatch</span><span class="o">(</span><span class="s">"..."</span><span class="o">);</span> <span class="c1">// Add in batch</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">addBatch</span><span class="o">(</span><span class="s">"..."</span><span class="o">);</span> <span class="c1">// Add in batch</span>
<span class="o">...</span>
<span class="n">stmt</span><span class="o">.</span><span class="na">executeBatch</span><span class="o">();</span> <span class="c1">// Execute together</span>
<span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span></code></pre></figure>

<p>Another example with <code class="highlighter-rouge">PreparedStatement</code>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span>
    <span class="s">"INSERT INTO Employees VALUES(?, ?)"</span><span class="o">);</span>
<span class="n">Employees</span><span class="o">[]</span> <span class="n">employees</span> <span class="o">=</span> <span class="o">...;</span>

<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">employees</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
     <span class="n">stmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">employees</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getAge</span><span class="o">());</span>
     <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">employees</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getName</span><span class="o">());</span>
     <span class="n">stmt</span><span class="o">.</span><span class="na">addBatch</span><span class="o">();</span> <span class="c1">// Add in batch</span>
<span class="o">}</span>

<span class="n">stmt</span><span class="o">.</span><span class="na">executeBatch</span><span class="o">();</span> <span class="c1">// Execute together</span></code></pre></figure>

<h2 id="ref">Ref</h2>

<ul>
  <li><a href="https://docs.oracle.com/cd/F49540_01/DOC/java.815/a64685/basic1.htm">Oracle JDBC driver</a></li>
  <li><a href="http://www.yiibai.com/jdbc/jdbc_quick_guide.html">JDBC快速入门教程</a></li>
</ul>


            <h3>Related Posts</h3>

            
            <a href="/android/Android-DragViewHelper/">Android DragViewHelper</a><br/>
            
            <a href="/android/Android-GestureDetector/">Android GestureDetector</a><br/>
            
            <a href="/android/Android-Shape/">Android Shape Drawable</a><br/>
            
            <a href="/android/Android-ListActivity/">Android ListActivity</a><br/>
            
            <a href="/android/Android-Fragment/">Android Fragment</a><br/>
            
            <a href="/android/Android-Toolbar/">Android Toolbar</a><br/>
            
            <a href="/css/CSS-Animation/">CSS Animation</a><br/>
            
            <a href="/mysql/MySQL-Index/">MySQL Index</a><br/>
            
            <a href="/mybatis/MyBatis-With-Spring/">MyBatis with Spring</a><br/>
            
            <a href="/mybatis/MyBatis-Advanced/">MyBatis association collection and discriminator</a><br/>
            
            <hr/>
            <div class="post-div">
                
                <a class="prev-link" href="/java/Java-Static-Loading-Order/"><span>&#8592;&#09;previous</span></a>
                
                <span class="nav-hint-mob"> You can also navigate with left [or] right arrows </span>
                
                <a class="next-link" href="/design%20pattern/Adapter/"><span>next&#09;&#8594;</span></a>
                
            </div>
            <!-- Comments -->
            <div class="comments">
    <div id="disqus_thread"></div>
    <script>
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//tt-cc.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</div>

        </div>

        <div class="col-md-4">
            <div id="search">
    <form action="/search" method="get" class="input-group">
        <input type="text" id="search-query" class="form-control search-query" name="q" placeholder="Search"
               autocomplete="off">
        <span class="input-group-btn">
            <button class="btn btn-default" type="button">
                <span class="glyphicon glyphicon-search"></span>
            </button>
        </span>
    </form>
</div>

<section id="search-results" style="display:none">
    <header class="page-header">
        <h2>Search results</h2>
    </header>

    <div class="entries">
    </div>
</section>


<script id="search-results-template" type="text/mustache">
  {{#entries}}
    <article>
      <h6>
        {{#date}}<small><time datetime="{{pubdate}}" pubdate>{{displaydate}}</time></small>{{/date}}
        <a href="{{url}}">{{title}}</a>
      </h6>
      {{#is_post}}
      <ul>
        {{#tags}}<li>{{.}} </li>{{/tags}}
      </ul>
      {{/is_post}}
    </article>
  {{/entries}}
</script>



<script src="/components/search-jekyll/search.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    $(function () {
        $('#search-query').lunrSearch({
            indexUrl: '/components/search-jekyll/index.json',
            results: '#search-results',
            entries: '.entries',
            template: '#search-results-template'
        });
    });
</script>

            <h3>Post Directory</h3>
<div id="post-directory-module">
<section class="post-directory">
    <!-- Links that trigger the jumping -->
    <!-- Added by javascript below -->
    <dl></dl>
</section>
</div>

<script type="text/javascript">

    $(document).ready(function(){
        $( "article h2" ).each(function( index ) {
            $(".post-directory dl").append("<dt><a class=\"jumper\" hre=#" +
                    $(this).attr("id")
                    + ">"
                    + $(this).text()
                    + "</a></dt>");

            var children = $(this).nextUntil("h2", "h3")

            children.each(function( index ) {
                $(".post-directory dl").append("<dd><a class=\"jumper\" hre=#" +
                        $(this).attr("id")
                        + ">"
                        + "&nbsp;&nbsp;- " + $(this).text()
                        + "</a></dd>");
            });
        });

        var fixmeTop = $('#post-directory-module').offset().top - 100;       // get initial position of the element

        $(window).scroll(function() {                  // assign scroll event listener

            var currentScroll = $(window).scrollTop(); // get current position

            if (currentScroll >= fixmeTop) {           // apply position: fixed if you
                $('#post-directory-module').css({      // scroll to that element or below it
                    top: '100px',
                    position: 'fixed',
                    width: 'inherit'
                });
            } else {                                   // apply position: static
                $('#post-directory-module').css({      // if you scroll above it
                    position: 'inherit',
                    width: 'inherit'
                });
            }

        });

        $("a.jumper").on("click", function( e ) {

            e.preventDefault();

            $("body, html").animate({
                scrollTop: ($( $(this).attr('hre') ).offset().top - 100)
            }, 600);

        });
    });

</script>
        </div>

    </div>

</article>

        </div>

    <footer class="container">

    <div class="site-footer">

        <div class="copyright pull-left">
            <!-- 请不要更改这一行 方便其他人知道模板的来源 谢谢 -->
            <!-- Please keep this line to let others know where this theme comes from. Thank you :D -->
            Power by <a href="https://github.com/DONGChuan/Yummy-Jekyll">Yummy Jekyll</a>
        </div>

        <a href="https://github.com/DONGChuan" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <div class="pull-right">
            <a href="javascript:window.scrollTo(0,0)">TOP</a>
        </div>

    </div>

    <!-- Third-Party JS -->
    <script type="text/javascript" src="/components/geopattern/js/geopattern.min.js"></script>

    <!-- My JS -->
    <script type="text/javascript" src="/assets/js/script.js"></script>

    

    <!-- Google Analytics -->
    <div style="display:none">
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function () {
                            (i[r].q = i[r].q || []).push(arguments)
                        }, i[r].l = 1 * new Date();
                a = s.createElement(o),
                        m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
            ga('create', 'UA-79713062-1', 'auto');
            ga('send', 'pageview');
        </script>
    </div>

</footer>


    </body>

</html>
